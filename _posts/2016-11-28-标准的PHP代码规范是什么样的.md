---
layout: post
category : lessons
tagline: ""
tags : [php]
---
{% include JB/setup %}

代码要写的好，第一需要有代码标准，第二要文档写的好（或者说是注释写的好）。

## 代码标准

PHP 目前的代码标准，是 PHP-FIG 组织提供的 PSR-1/PSR-2 [标准](http://www.php-fig.org/psr/psr-2)，标准这个东西只要有组织和大型框架支持，就会比较的流行。是什么标准并不是很重要，但必须要有一种标准。

另外 CodeIgniter 框架的[代码规范]((https://www.codeigniter.com/user_guide/general/styleguide.html))也可以参考  。

大部分 IDE 都有 PSR2 标准的模版，也能完成自动格式化的功能，但是建议不要依赖 IDE，需要对代码标准有一定的了解（甚至是为什么制定具体的标准），以下是我觉得比较重要的代码规范：

- PHP 代码的编码格式必须只使用不带字节顺序标记(BOM)的 UTF-8
- 遵循每个文件只干一件事情的原则，比如一个类一个文件。文件名有效和命名空间结合。
- 类名首字母大写，且符合 `StudlyCaps` 的写法；方法名首字母小写，且符合 `camelCase()` 的写法。
- 变量的命名建议同方法的命名类似，名词之间可以用下划线分开。变量名最好是一个名词。
- 类的左花括号必须放到下一行，右花括号必须放在类主体的下一行。
- 方法的左花括号必须放在下一行，右花括号必须放在方法主体下面。方法的取名最好具备动词+名词的作用。
- 控制结构的关键词：必须在后面有一个空格（方法和函数不可有）；左花括号必须放在同一行，右花括号必须放在控制主体的下一行；左括号后面不可有空格，右括号之前不可有空格。
- PHP 的关键词必须使用小写，比如 true 不要写成 TRUE。
- 函数参数列表：在参数列表中，逗号之前不可有空格，逗号之后必须要有一个空格。方法中有默认值的参数必须放在参数列表的最后面。参数列表可以被分为多个有一次缩进的多个后续行，每行一个参数，右括号（最后一个参数后）和左花括号必须夹带一个空格放在一起自成一行。
- 函数调用：要调用一个方法或函数，在方法或者函数名和左括号之间不可有空格，左括号之后不可有空格，右括号之前不可有空格。函数列表中，逗号之前不可有空格，逗号之后必须有一个空格。

## 代码注释

代码标准一般不包含代码注释，但是有效的代码注释非常的重要，建议使用 [DocBlocks 风格](https://phpdoc.org/docs/latest/guides/docblocks.html)的代码标准。

首先明确几个概念：
- phpDocumentor（PhpDoc）是一个代码文档生成器。
- DocBlock 是一个类 C-style 的注释标准，用来文档化块状代码。

许多 IDE 都提供了代码完成（能够解析 PhpDoc 注释）功能，并且能够自动进行 type-hinting

DocBlocks 包含三部分，每部分之间用一个空白行分隔，第一部分称为 Summary，描述简短的信息。第二部分称为 Description，提供一些详细的信息（比如函数的算法描述，用列说明，或者应用程序的架构）。第三部分称为 Tags，主要简洁的描述相关 Structural 元素（比如类或者函数）的一些 meta信息，每个 tag 以 @符号开始新一行。

PhpDoc 还能自动嵌入 HTML 元素。

Structural元素包含：

- 文件
- 命名空间
- require/include
- class
- interface
- trait
- function 
- property
- constant

几个比较重要的 概念 ：

- @package ：对于一组关联比较大的代码元素，建议使用 @package，可以指定文件或者类属于同样的包（包括继承的包），@package tag 能够在 a file-level or class-level DocBlock 中使用。
- File-level DocBlocks：通常用来文档化一个文件，通常包含 @package, @subpackage, @license, and @author 等 tag。
- class-level DocBlock ：通常用来描述一个类。

代码注释的一个例子：

```
/**
 * 演示 PhpDoc 功能的一个文件
 *
 * 通过这个演示，你能明白什么是 PhpDoc，以及如何优雅的写注释。
 *
 * @package    PhpDocProject
 * @subpackage Common
 * @license    http://opensource.org/licenses/gpl-license.php  GNU Public License
 * @author     ywdblog <ywdblog@gmail.com>
 * @version 1.0
 */
//

/**
 * 包含文件
 */
include 'function.php';

/**
 * 声明全局变量

 * @global integer $GLOBALS['_myvar']
 * @name $_myvar
 */
$GLOBALS['_myvar'] = 6;

/**
 * 声明全局常量
 */
define('NUM', 6);

/**
 * An PhpDoc example class
 *
 * 描述 PhpDoc 的一个类，包含 常量，变量，方法，构造函数等等
 *
 * @package    PhpDocProject
 * @subpackage Common
 * @author     ywdblog <ywdblog@gmail.com>
 */
class PhpDocExample
{
    /**
     *  @var string|null Should contain a description if available
     *  @access protected
     */
    protected $description = null;

    /**
     * 一个函数的说明例子
     *
     * <code>
     * $obj->getFunction
     * </code>
     *
     * @param int|string $user 是一个名字
     * @param PDO $pdo A valid PDO object
     * @return User Returns User object or null if not found
     * @throws Exception
     * @todo Description
     * @deprecated since version number
     * @example path description
     *
     */
    function getFunction($user, PDO $pdo)
    {
        if ($isFound) {
            return new User(...);
        }
        return null;
    }
}
```



 




