---
layout: post
category : lessons
tagline: ""
tags : [php]
---
{% include JB/setup %}

在 packagist 上找了一个 RSS 解析器[类包](https://packagist.org/packages/vinelab/rss)，由于自己的实际需要，对这个包做了两个调整：

（1）这个包只支持远程的 XML 地址（HTTP 开头的），而自己开发的项目中，需要解析本地磁盘中的 XML 文件，研究并修改了下源码。

修改 vinelab\rss\src\Vinelab\Rss\Rss.php，增加一个函数：

```
public function feedNative($url)
{
    $o = new \SimpleXMLElement(file_get_contents($url));
    return $this->xml->parse($o);
}
```

调用：

```
$rss  = new Rss();
$feed = $rss->feedNative('rss.xml');
echo $feed->articlesCount(); // 10
```

（2）假如一个 RSS 文件中没有 item 标签，则代码直接会报异常，修改了下 vendor\vinelab\rss\src\Vinelab\Rss\Parsers\XML.php：

```
if (!isset($xml->channel->item)) {
    // throw new InvalidFeedContentException();
}
```